import{_ as s,v as t,b as a,R as n}from"./chunks/framework.caa0fbaf.js";const h=JSON.parse('{"title":"http接口服务","description":"","frontmatter":{},"headers":[],"relativePath":"guide/api/httpApi.md","filePath":"guide/api/httpApi.md","lastUpdated":1691029002000}'),o={name:"guide/api/httpApi.md"},p=n(`<h1 id="http接口服务" tabindex="-1">http接口服务 <a class="header-anchor" href="#http接口服务" aria-label="Permalink to &quot;http接口服务&quot;">​</a></h1><h2 id="概要" tabindex="-1">概要 <a class="header-anchor" href="#概要" aria-label="Permalink to &quot;概要&quot;">​</a></h2><p><code>YinTao</code> 启动后默认占用本机<code>8777</code>端口,对外提供<code>http</code>服务。</p><h2 id="执行" tabindex="-1">执行 <a class="header-anchor" href="#执行" aria-label="Permalink to &quot;执行&quot;">​</a></h2><p>路径: <code>/run</code></p><p>请求方式: <code>POST</code></p><p>说明: <code>运行脚本时调用,运行报告随请求返回, 当填写remoteReport时，会立即返回空,执行结果会通过异步返回</code></p><p>参数:</p><table><thead><tr><th>名称</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>script</td><td>string</td><td>空</td><td>执行的脚本</td></tr><tr><td>storage</td><td>any</td><td>空</td><td>自定义参数仓库</td></tr><tr><td>headless</td><td>boolean</td><td>fasle</td><td>无头模式，默认为显示界面运行，true开启无头运行</td></tr><tr><td>browser</td><td>string</td><td>&#39;chrome&#39;</td><td>执行使用的浏览器支持 <code>chrome</code>、<code>firefox</code>、<code>webkit</code></td></tr><tr><td>hosts</td><td>Map</td><td>空</td><td>host信息 <code>{&quot;域名&quot;:&quot;解析IP地址&quot;}</code></td></tr><tr><td>cookies</td><td><a href="https://dqa.jd.com/YinTao/guide/data/cookie.html" target="_blank" rel="noreferrer">Cookie</a>[]</td><td>空</td><td>可接收cookie数组,用于初始化配置</td></tr><tr><td>remoteReport</td><td>object</td><td>空</td><td>远程执行需要上报的地址</td></tr></tbody></table><p>remoteReport 类型:object:</p><table><thead><tr><th>名称</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>result</td><td>string</td><td>空</td><td>远程上传结果地址</td></tr><tr><td>log</td><td>string</td><td>空</td><td>远程上传日志地址</td></tr><tr><td>image</td><td>string</td><td>空</td><td>远程上传图片地址</td></tr><tr><td>trace</td><td>string</td><td>空</td><td>远程上传追踪地址,支持本地路径以及http地址。<a href="https://dqa.jd.com/YinTao/guide/course/trace.html" target="_blank" rel="noreferrer">问题追踪</a></td></tr></tbody></table><p>请求示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">request</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:8777/run</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">storage</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">123</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">await page.to(&quot;https://www.baidu.com&quot;)</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">hosts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">nn2.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">11.91.160.125</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">timeout</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">99999999</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    )</span></span></code></pre></div><p>响应结果</p><table><thead><tr><th>名称</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>success</td><td>boolean</td><td>false</td><td>执行结果</td></tr><tr><td>duration</td><td>number</td><td>无</td><td>执行持续时间 单位/ms</td></tr><tr><td>start_time</td><td>boolean</td><td>false</td><td>开始执行的时间 单位/ms</td></tr><tr><td>msg</td><td>string</td><td>无</td><td>结果提示消息</td></tr><tr><td>divertor</td><td>Divertor</td><td>空</td><td>断言信息</td></tr><tr><td>log</td><td>string</td><td>空</td><td>日志信息</td></tr></tbody></table><p>Divertor</p><table><thead><tr><th>名称</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>msg</td><td>string</td><td>空</td><td>错误描述</td></tr><tr><td>code</td><td>string</td><td>空</td><td>相关代码</td></tr><tr><td>success</td><td>boolean</td><td>false</td><td>是否成功</td></tr></tbody></table><p>响应示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">duration</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#F78C6C;">3488</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">start_time</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#F78C6C;">1615550400079</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">msg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">执行成功</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">divertor</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: []</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">: </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="录制脚本" tabindex="-1">录制脚本 <a class="header-anchor" href="#录制脚本" aria-label="Permalink to &quot;录制脚本&quot;">​</a></h2><p>路径: <code>/live</code></p><p>请求方式: <code>POST</code></p><p>说明: <code>录制脚本时调用,脚本随请求响应返回</code></p><p>参数:</p><table><thead><tr><th>名称</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>url</td><td>string</td><td>空</td><td>录制时默认打开的地址</td></tr><tr><td>compatibility</td><td>bool</td><td>空</td><td>兼容模式,默认采用YinTao浏览器,开启后将使用Chromium</td></tr><tr><td>storage</td><td>any</td><td>空</td><td>自定义参数仓库</td></tr><tr><td>cookies</td><td><a href="https://dqa.jd.com/YinTao/guide/data/cookie.html" target="_blank" rel="noreferrer">Cookie</a>[]</td><td>空</td><td>可接收cookie数组,用于初始化配置</td></tr><tr><td>device</td><td>string</td><td>空</td><td>模拟移动设备录制, 支持的字段参考<a href="https://coding.jd.com/YinTao/core/blob/master/src/server/deviceDescriptorsSource.json" target="_blank" rel="noreferrer">setDevice</a></td></tr><tr><td>hosts</td><td>Map</td><td>空</td><td>host信息 <code>{&quot;域名&quot;:&quot;解析IP地址&quot;}</code></td></tr></tbody></table><p>请求示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">request</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:8777/live</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://baidu.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">storage</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">123</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">hosts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">nn2.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">11.91.160.125</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">timeout</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">99999999</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    )</span></span></code></pre></div><p>响应结果</p><table><thead><tr><th>名称</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>script</td><td>string</td><td>无</td><td>录制生成的脚本</td></tr><tr><td>code</td><td>number</td><td>无</td><td>错误代码</td></tr><tr><td>msg</td><td>string</td><td>无</td><td>描述信息</td></tr></tbody></table><p>响应示例:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;script&quot;: &quot;await page.to(&#39;https://www.baidu.com&#39;)\\nawait getDom(&#39;#kw&#39;); await set(\\&quot;hello word\\&quot;);\\nawait getDom(&#39;#su&#39;); await click()\\n&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;code&quot;  : 2000</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;msg&quot;   : &quot;success!&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span></code></pre></div><h2 id="ping" tabindex="-1">ping <a class="header-anchor" href="#ping" aria-label="Permalink to &quot;ping&quot;">​</a></h2><p>路径: <code>/ping</code></p><p>请求方式: <code>GET</code></p><p>说明: <code>可用于检测driver是否运行</code></p><p>请求示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:8777/ping</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>响应示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ok</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">:</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="退出" tabindex="-1">退出 <a class="header-anchor" href="#退出" aria-label="Permalink to &quot;退出&quot;">​</a></h2><p>路径: <code>/exit</code></p><p>请求方式: <code>GET</code></p><p>说明: <code>调用后关闭YinTao</code></p><p>请求示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:8777/exit</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>响应示例:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ok</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">:</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div>`,47),l=[p];function e(r,c,d,D,F,y){return t(),a("div",null,l)}const C=s(o,[["render",e]]);export{h as __pageData,C as default};
